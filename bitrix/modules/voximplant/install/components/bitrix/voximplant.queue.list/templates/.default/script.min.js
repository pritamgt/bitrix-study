(function(e){BX.namespace("BX.Voximplant");var t=null;var n="/bitrix/components/bitrix/voximplant.queue.list/ajax.php";var a="voximplant_queue_list";BX.Voximplant.QueueList=function(){};BX.Voximplant.QueueList.getInstance=function(){if(t===null){t=new BX.Voximplant.QueueList}return t};BX.Voximplant.QueueList.prototype.delete=function(t){var o=this;t=parseInt(t);var s={action:"delete",sessid:BX.bitrix_sessid(),id:t};var i=BX.showWait();BX.ajax({url:n,method:"POST",data:s,dataType:"json",onsuccess:function(e){BX.closeWait(null,i);if(!e.SUCCESS&&e.USAGES){o.showUsages(e.USAGES)}else{var t=BX.Main.gridManager.getInstanceById(a);if(t)t.reload()}},onfailure:function(){BX.closeWait(null,i);e.alert("Network error")}})};BX.Voximplant.QueueList.prototype.showUsages=function(e){var t=new BX.PopupWindow("vi-queue-usage",null,{closeIcon:true,closeByEsc:true,autoHide:false,titleBar:BX.message("VOX_QUEUE_DELETE_ERROR"),content:this.renderUsagePopup(e),overlay:{color:"gray",opacity:30},buttons:[new BX.PopupWindowButton({id:"close",text:BX.message("VOX_QUEUE_CLOSE"),events:{click:function(){t.close()}}})],events:{onPopupClose:function(){this.destroy()},onPopupDestroy:function(){t=null}}});t.show()};BX.Voximplant.QueueList.prototype.renderUsagePopup=function(e){return BX.create("div",{children:[BX.create("div",{props:{className:"vi-queue-popup-header"},text:BX.message("VOX_QUEUE_IS_USED")}),BX.create("table",{children:this.renderUsages(e)})]})};BX.Voximplant.QueueList.prototype.renderUsages=function(e){var t=[];var n;for(var a=0;a<e.length;a++){n=e[a];t.push(BX.create("tr",{children:[BX.create("td",{children:[BX.create("span",{props:{className:"vi-queue-popup-usage-item"},text:(n.TYPE==="CONFIG"?BX.message("VOX_QUEUE_NUMBER"):BX.message("VOX_QUEUE_IVR"))+": "})]}),BX.create("td",{children:[BX.create("a",{text:n.TITLE,attrs:{href:n.URL,target:"_blank"}})]})]}))}return t}})(window);
//# sourceMappingURL=script.map.js