BX.namespace("BX.Disk");BX.Disk.BreadcrumbsClass=function(){var t=function(t){this.containerId=t.containerId;this.collapsedCrumbs=t.collapsedCrumbs||[];this.showOnlyDeleted=t.showOnlyDeleted||0;this.enableDropdown=t.enableDropdown;this.container=BX(this.containerId);this.ajaxUrl="/bitrix/components/bitrix/disk.breadcrumbs/ajax.php";this.container.style.opacity=1;this.setEvents()};t.prototype.setEvents=function(){if(this.enableDropdown){BX.bindDelegate(this.container,"click",{className:"icon-arrow"},BX.proxy(this.onClickArrow,this))}else{BX.bindDelegate(this.container,"click",{className:"icon-arrow"},function(t){BX.PreventDefault(t)})}BX.bind(BX("root_dots_"+this.containerId),"click",BX.proxy(this.onClickDots,this))};t.prototype.adjust=function(){var t=BX.findParent(this.container,{className:"bx-disk-interface-toolbar-container"},BX("workarea-content"));if(t){var e=BX.findChild(t,{className:"bx-disk-interface-sort"},true)}var i=this.container.offsetWidth;var a=t?t.offsetWidth:0;var r=e?e.offsetWidth:0;if(!a){return}var n=r+i;if(a>n){return}var o=BX.findChildren(this.container,{tagName:"span",className:"bx-disk-interface-bread-crumbs-item"},true);var s=o.shift();var d=o.pop();this.collapsedCrumbs=[];for(var c in o){if(r+this.container.offsetWidth-a<=0){break}if(!o.hasOwnProperty(c)){continue}var l=o[c];var u=BX.nextSibling(l);var h=0;if(BX.hasClass(u,"bx-disk-bread-crumbs-separator")){h=u.offsetWidth}else{u=null}this.collapsedCrumbs.push({text:l.getAttribute("data-objectName"),title:l.getAttribute("data-objectName"),href:l.getAttribute("data-objectParentPath")});BX.hide(l);u&&BX.hide(u)}if(r+this.container.offsetWidth-a>0){this.collapsedCrumbs.unshift({text:s.getAttribute("data-objectName"),title:s.getAttribute("data-objectName"),href:s.getAttribute("data-objectParentPath")});BX.hide(s)}BX("root_dots_"+this.containerId).style.display="inline-block";BX("root_arrow_"+this.containerId).style.display="none";BX.bind(BX("root_dots_"+this.containerId),"click",BX.proxy(this.onClickDots,this))};t.prototype.expand=function(t,e,i){var a=t.getAttribute("data-objectId");var r=t.getAttribute("data-objectParentPath");if(r=="/"){r=""}else if(r.lastIndexOf("/")==r.length-1){r=r.substr(0,r.length-1)}var n=[];for(var o in i){if(!i.hasOwnProperty(o)){continue}var s=i[o];n.push({text:s["name"],title:s["name"],href:r+"/"+encodeURIComponent(s["name"])+"/"})}BX.PopupMenu.show("disk_breadcrumbs_"+a,e,n,{autoHide:true,angle:{offset:0},events:{onPopupClose:function(){}}})};t.prototype.onClickDots=function(t){var e=t.srcElement||t.target;BX.PopupMenu.show("disk_breadcrumbs_dots",e,this.collapsedCrumbs,{autoHide:true,angle:{offset:0},events:{onPopupClose:function(){}}});BX.PreventDefault(t)};t.prototype.onClickArrow=function(t){var e=t.srcElement||t.target;var i=BX.findParent(e,{className:"bx-disk-interface-bread-crumbs-item-container"},this.container);var a=i.getAttribute("data-objectId");var r=i.getAttribute("data-isRoot");if(!a){BX.PreventDefault(t);return}var n=BX.PopupMenu.getMenuById("disk_breadcrumbs_"+a);if(n&&n.popupWindow){if(n.popupWindow.isShown()){BX.PopupMenu.destroy("disk_breadcrumbs_"+a)}else{n.popupWindow.show()}BX.PreventDefault(t);return}BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","showSubFolders"),data:{objectId:a,showOnlyDeleted:this.showOnlyDeleted?1:0,isRoot:r?1:0},onsuccess:BX.delegate(function(t){if(!t){return}this.expand(i,e,t.items)},this)});BX.PreventDefault(t)};return t}();
//# sourceMappingURL=script.map.js