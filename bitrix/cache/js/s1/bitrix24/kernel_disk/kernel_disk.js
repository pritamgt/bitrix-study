; /* /bitrix/js/disk/c_disk.min.js?152698248521443*/
; /* /bitrix/js/disk/file_dialog.min.js?152698248525023*/
; /* /bitrix/js/disk/queue.min.js?15269824851061*/
; /* /bitrix/js/disk/external_loader.min.js?15269824854180*/

; /* Start:"a:4:{s:4:"full";s:45:"/bitrix/js/disk/c_disk.min.js?152698248521443";s:6:"source";s:25:"/bitrix/js/disk/c_disk.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
BX.namespace("BX.Disk");if(!BX.Disk.pathToUser){BX.Disk=function(){var e=null;var t={};var s={};var a={};var i=function(e){if(!e.RealAnchor||!BX.hasClass(e.RealAnchor,"js-disk-locked-document-tooltip")){return}var t=BX.findChildByClassName(e.ROOT_DIV,"bx-user-info-data-info",true);if(!t){return}if(BX.findChildByClassName(t,"js-disk-locked-status",true)){return}BX.prepend(BX.create("div",{html:'<span class="field-name">'+BX.message("DISK_JS_USER_LOCKED_DOCUMENT")+"</span>",props:{className:"js-disk-locked-status"}}),t)};BX.addCustomEvent("onTooltipShow",i);BX.addCustomEvent("onTooltipInsertData",i);BX.addCustomEvent("onTooltipHide",function(e){if(!e.RealAnchor||!BX.hasClass(e.RealAnchor,"js-disk-locked-document-tooltip")){return}var t=BX.findChildByClassName(e.ROOT_DIV,"js-disk-locked-status",true);if(!t){return}BX.remove(t)});function n(e){e.data=e.data||{};e.data["SITE_ID"]=BX.message("SITE_ID");e.data["sessid"]=BX.bitrix_sessid();return e}return{pathToUser:"/company/personal/user/#user_id#/",ajax:function(e){return BX.ajax(n(e))},ajaxPromise:function(e){return BX.ajax.promise(n(e)).then(function(e){if(!e||e.status!="success"){BX.Disk.showModalWithStatusAction(e);var t=new BX.Promise;t.reject(e);return t}return e})},isEmptyObject:function(e){if(e==null)return true;if(e.length&&e.length>0)return false;if(e.length===0)return true;for(var t in e){if(hasOwnProperty.call(e,t))return false}return true},_keyPress:function(t){var s=(t||window.event).keyCode||(t||window.event).charCode;if(s==13&&e){BX.fireEvent(e,"click");return BX.PreventDefault(t)}},modalWindow:function(t){t=t||{};t.title=t.title||false;t.bindElement=t.bindElement||null;t.overlay=typeof t.overlay=="undefined"?true:t.overlay;t.autoHide=t.autoHide||false;t.closeIcon=typeof t.closeIcon=="undefined"?true:t.closeIcon;t.modalId=t.modalId||"disk_modal_window_"+(Math.random()*(2e5-100)+100);t.withoutContentWrap=typeof t.withoutContentWrap=="undefined"?false:t.withoutContentWrap;t.contentClassName=t.contentClassName||"";t.contentStyle=t.contentStyle||{};t.content=t.content||[];t.buttons=t.buttons||false;t.events=t.events||{};t.withoutWindowManager=!!t.withoutWindowManager||false;var s=[];if(t.withoutContentWrap){s=s.concat(t.content)}else{s.push(BX.create("div",{props:{className:"bx-disk-popup-content "+t.contentClassName},style:t.contentStyle,children:t.content}))}var i=t.buttons;if(t.htmlButtons){var n=[];for(var o in t.htmlButtons){if(!t.htmlButtons.hasOwnProperty(o)){continue}if(o>0){n.push(BX.create("SPAN",{html:"&nbsp;"}))}n.push(t.htmlButtons[o])}s.push(BX.create("div",{props:{className:"bx-disk-popup-buttons"},children:n}))}var r=BX.create("div",{props:{className:"bx-disk-popup-container"},children:s});var p=t.events.onPopupClose;t.events.onPopupClose=BX.delegate(function(){e=null;try{BX.unbind(document,"keydown",BX.proxy(this._keypress,this))}catch(e){}if(p){BX.delegate(p,BX.proxy_context)()}if(t.withoutWindowManager){delete a[t.modalId]}BX.proxy_context.destroy()},this);var d;if(t.withoutWindowManager){if(!!a[t.modalId]){return a[t.modalId]}d=new BX.PopupWindow(t.modalId,t.bindElement,{titleBar:t.title,content:r,closeByEsc:true,closeIcon:t.closeIcon,autoHide:t.autoHide,overlay:t.overlay,events:t.events,buttons:t.buttons,zIndex:isNaN(t["zIndex"])?0:t.zIndex});a[t.modalId]=d}else{d=BX.PopupWindowManager.create(t.modalId,t.bindElement,{titleBar:t.title,content:r,closeByEsc:true,closeIcon:t.closeIcon,autoHide:t.autoHide,overlay:t.overlay,events:t.events,buttons:t.buttons,zIndex:isNaN(t["zIndex"])?0:t.zIndex})}d.show();return d},modalWindowLoader:function(e,t,s){s=s||null;t=t||{};var a=t.id;var i=t.responseType||"html";var n=t.afterSuccessLoad||null;var o=t.onPopupClose||null;var r=t.postData||{};var p=BX.PopupWindowManager.create("bx-disk-"+a,s,{closeIcon:true,offsetTop:5,autoHide:true,lightShadow:false,overlay:true,content:BX.create("div",{children:[BX.create("div",{style:{display:"table",width:"30px",height:"30px"},children:[BX.create("div",{style:{display:"table-cell",verticalAlign:"middle",textAlign:"center"},children:[BX.create("div",{props:{className:"bx-disk-wrap-loading-modal"}}),BX.create("span",{text:""})]})]})]}),closeByEsc:true,events:{onPopupClose:function(){if(o){BX.delegate(o,this)()}this.destroy()}}});p.show();r["sessid"]=BX.bitrix_sessid();r["SITE_ID"]=BX.message("SITE_ID");BX.ajax({url:e,method:"POST",dataType:i,data:r,onsuccess:BX.delegate(function(e){if(i=="html"){p.setContent(BX.create("DIV",{html:e}));p.adjustPosition()}else if(i=="json"){e=e||{}}n&&n(e,p)},this),onfailure:function(e){}})},addToLinkParam:function(e,t,s){if(!e.length){return"?"+t+"="+s}e=BX.util.remove_url_param(e,t);if(e.indexOf("?")!=-1){return e+"&"+t+"="+s}return e+"?"+t+"="+s},getFirstErrorFromResponse:function(e){e=e||{};if(!e.errors)return"";return e.errors.shift().message},showModalWithStatusAction:function(e,t){e=e||{};var s=e.dontCloseCurrentPopupWindow||false;if(!e.message){if(e.status=="success"){e.message=BX.message("DISK_JS_STATUS_ACTION_SUCCESS")}else{e.message=BX.message("DISK_JS_STATUS_ACTION_ERROR")+". "+this.getFirstErrorFromResponse(e)}}var a=BX.create("div",{props:{className:"bx-disk-alert"},children:[BX.create("span",{props:{className:"bx-disk-aligner"}}),BX.create("span",{props:{className:"bx-disk-alert-text"},text:e.message}),BX.create("div",{props:{className:"bx-disk-alert-footer"}})]});var i=BX.PopupWindowManager.getCurrentPopup();if(i){if(!s||!i.isShown()||i.uniquePopupId==="bx-disk-status-action"){i.destroy()}else{return}}var n=setTimeout(function(){var e=BX.PopupWindowManager.getCurrentPopup();if(!e||e.uniquePopupId!="bx-disk-status-action"){return}e.close();e.destroy()},3e3);var o=BX.PopupWindowManager.create("bx-disk-status-action",null,{content:a,closeIcon:true,events:{onPopupClose:function(){this.destroy();clearTimeout(n)}},autoHide:true,zIndex:10200,className:"bx-disk-alert-popup"});o.show();BX("bx-disk-status-action").onmouseover=function(e){clearTimeout(n)};BX("bx-disk-status-action").onmouseout=function(e){n=setTimeout(function(){var e=BX.PopupWindowManager.getCurrentPopup();if(!e||e.uniquePopupId!="bx-disk-status-action"){return}e.close();e.destroy()},3e3)}},showActionModal:function(e){var t=e.text;var s=e.autoHide;var a;if(e.showLoaderIcon){a="/bitrix/js/main/core/images/yell-waiter.gif"}else if(e.showSuccessIcon){a="/bitrix/js/main/core/images/viewer-tick.png"}else if(!!e.icon){a=e.icon}var i=BX.create("div",{props:{className:"bx-disk-alert"},children:[BX.create("span",{props:{className:"bx-disk-alert-icon"},children:[a?BX.create("img",{props:{src:a}}):null]}),BX.create("span",{props:{className:"bx-disk-aligner"}}),BX.create("span",{props:{className:"bx-disk-alert-text"},text:t}),BX.create("div",{props:{className:"bx-disk-alert-footer"}})]});var n=BX.PopupWindowManager.getCurrentPopup();if(n){n.destroy()}var o=setTimeout(function(){if(!s){return}var e=BX.PopupWindowManager.getCurrentPopup();if(!e||e.uniquePopupId!="bx-disk-status-action"){return}e.close();e.destroy()},3e3);var r=BX.PopupWindowManager.create("bx-disk-status-action",null,{content:i,onPopupClose:function(){this.destroy();clearTimeout(o)},autoHide:s,zIndex:10200,className:"bx-disk-alert-popup"});r.show();BX("bx-disk-status-action").onmouseover=function(e){clearTimeout(o)};if(!s){return}BX("bx-disk-status-action").onmouseout=function(e){o=setTimeout(function(){var e=BX.PopupWindowManager.getCurrentPopup();if(!e||e.uniquePopupId!="bx-disk-status-action"){return}e.close();e.destroy()},3e3)}},storePathToUser:function(e){if(e){this.pathToUser=e}},getUrlForDownloadDesktop:function(){return BX.browser.IsMac()?"http://dl.bitrix24.com/b24/bitrix24_desktop.dmg":"http://dl.bitrix24.com/b24/bitrix24_desktop.exe"},getUrlToShowObjectInGrid:function(e,t){return"/bitrix/tools/disk/focus.php?ncc=1&action=showObjectInGrid&objectId="+encodeURIComponent(e)+"&SITE_ID="+encodeURIComponent(BX.message("SITE_ID"))+(t?"&cmd="+encodeURIComponent(t):"")},getDownloadDesktop:function(){document.location.href=this.getUrlForDownloadDesktop()},deactiveBanner:function(e){BX.userOptions.save("disk","~banner-offer",e,true);BX.userOptions.send(null)},getPathToUser:function(e){return this.pathToUser.replace("#USER_ID#",e).replace("#user_id#",e)},getNumericCase:function(e,t,s,a,i){if(e==1){return t}if(e<0){e=-e}e%=100;if(e>=5&&e<=20){return i}e%=10;if(e==1){return s}if(e>=2&&e<=4){return a}return i},getRightLabelByTaskName:function(e){switch(e.toLowerCase()){case"disk_access_read":return BX.message("DISK_JS_SHARING_LABEL_RIGHT_READ");case"disk_access_add":return BX.message("DISK_JS_SHARING_LABEL_RIGHT_ADD");case"disk_access_edit":return BX.message("DISK_JS_SHARING_LABEL_RIGHT_EDIT");case"disk_access_full":return BX.message("DISK_JS_SHARING_LABEL_RIGHT_FULL");default:return"error"}},appendNewShared:function(e){var s=e.readOnly;var a=e.maxTaskName||"disk_access_full";var i=e.destFormName;var n=e.item.id;var o=e.item.name;var r=e.item.avatar;var p=e.type;var d=e.right||"disk_access_read";t[n]={item:e.item,type:e.type,right:d};function l(e,t){var s;var a;switch(e){case"disk_access_read":s=2;break;case"disk_access_add":s=3;break;case"disk_access_edit":s=4;break;case"disk_access_full":s=5;break;default:return 0}switch(t){case"disk_access_read":a=2;break;case"disk_access_add":a=3;break;case"disk_access_edit":a=4;break;case"disk_access_full":a=5;break;default:return 0}if(s==a){return 0}return s>a?1:-1}BX("bx-disk-popup-shared-people-list").appendChild(BX.create("tr",{attrs:{"data-dest-id":n},children:[BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col1"},children:[BX.create("a",{props:{className:"bx-disk-filepage-used-people-link"},children:[BX.create("span",{props:{className:"bx-disk-filepage-used-people-avatar "+(p!="users"?" group":"")},style:{backgroundImage:r?"url("+r+")":null}}),BX.util.htmlspecialchars(o)]})]}),BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col2"},children:[BX.create("a",{props:{className:"bx-disk-filepage-used-people-permission"},style:{cursor:"pointer"},text:this.getRightLabelByTaskName(d),events:{click:BX.delegate(function(e){if(s){return BX.PreventDefault(e)}var i=e.target||e.srcElement;BX.PopupMenu.show("disk_open_menu_with_rights",BX(i),[l(a,"disk_access_read")>=0?{text:BX.message("DISK_JS_SHARING_LABEL_RIGHT_READ"),href:"#",onclick:BX.delegate(function(e){BX.PopupMenu.destroy("disk_open_menu_with_rights");BX.adjust(i,{text:this.getRightLabelByTaskName("disk_access_read")});BX.onCustomEvent("onChangeRightOfSharing",[n,"disk_access_read"]);t[n]["right"]="disk_access_read";return BX.PreventDefault(e)},this)}:null,l(a,"disk_access_add")>=0?{text:BX.message("DISK_JS_SHARING_LABEL_RIGHT_ADD"),href:"#",onclick:BX.delegate(function(e){BX.PopupMenu.destroy("disk_open_menu_with_rights");BX.adjust(i,{text:this.getRightLabelByTaskName("disk_access_add")});BX.onCustomEvent("onChangeRightOfSharing",[n,"disk_access_add"]);t[n]["right"]="disk_access_add";return BX.PreventDefault(e)},this)}:null,l(a,"disk_access_edit")>=0?{text:BX.message("DISK_JS_SHARING_LABEL_RIGHT_EDIT"),href:"#",onclick:BX.delegate(function(e){BX.PopupMenu.destroy("disk_open_menu_with_rights");BX.adjust(i,{text:this.getRightLabelByTaskName("disk_access_edit")});BX.onCustomEvent("onChangeRightOfSharing",[n,"disk_access_edit"]);t[n]["right"]="disk_access_edit";return BX.PreventDefault(e)},this)}:null,l(a,"disk_access_full")>=0?{text:BX.message("DISK_JS_SHARING_LABEL_RIGHT_FULL"),href:"#",onclick:BX.delegate(function(e){BX.PopupMenu.destroy("disk_open_menu_with_rights");BX.adjust(i,{text:this.getRightLabelByTaskName("disk_access_full")});BX.onCustomEvent("onChangeRightOfSharing",[n,"disk_access_full"]);t[n]["right"]="disk_access_full";return BX.PreventDefault(e)},this)}:null],{angle:{position:"top",offset:45},autoHide:true,overlay:{opacity:.01},events:{onPopupClose:function(){BX.PopupMenu.destroy("disk_open_menu_with_rights")}}})},this)}})]}),BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col3 tar"},children:[!s?BX.create("span",{props:{className:"bx-disk-filepage-used-people-del"},events:{click:BX.delegate(function(e){BX.SocNetLogDestination.deleteItem(n,p,i);var t=e.target||e.srcElement;BX.remove(t.parentNode.parentNode)},this)}}):null]})]}))},openPopupMenuWithRights:function(e,t){var a=[];var i;var n=e.target||e.srcElement;for(var o in s){if(!s.hasOwnProperty(o)){continue}i=BX.clone(s[o],true);a.push({task:i,text:i.TITLE,href:"#",onclick:function(e,s){BX.adjust(n,{text:s.task.TITLE});BX.onCustomEvent("onChangeRight",[t,s.task]);BX.onCustomEvent("onChangeSystemRight",[t,s.task]);BX.PopupMenu.destroy("disk_open_menu_with_rights");return BX.PreventDefault(e)}})}BX.PopupMenu.show("disk_open_menu_with_rights",BX(n),a,{angle:{position:"top",offset:45},autoHide:true,overlay:{opacity:.01},events:{onPopupClose:function(){BX.PopupMenu.destroy("disk_open_menu_with_rights")}}})},setModuleTasks:function(e){s=e},getFirstModuleTask:function(){if(this.isEmptyObject(s)){return{}}for(var e in s){if(s.hasOwnProperty(e)&&typeof e!=="function"){return s[e];break}}return{}},appendRight:function(e){var t=e.readOnly;var a=e.detachOnly||false;var i=e.destFormName;var n=e.item.id;var o=e.item.name;var r=e.item.avatar;var p=e.type;var d=e.right||{};if(!d.title&&d.id){d.title=s[d.id].TITLE}else if(!d.title){var l=this.getFirstModuleTask();d={id:l.ID,title:l.TITLE};BX.onCustomEvent("onChangeRight",[n,l])}var c=d.title;BX("bx-disk-popup-shared-people-list").appendChild(BX.create("tr",{attrs:{"data-dest-id":n},children:[BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col1"},children:[BX.create("a",{props:{className:"bx-disk-filepage-used-people-link"},children:[BX.create("span",{props:{className:"bx-disk-filepage-used-people-avatar "+(p!="users"?" group":"")},style:{backgroundImage:r?"url("+r+")":null}}),BX.util.htmlspecialchars(o)]})]}),BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col2"},children:[BX.create("a",{props:{className:"bx-disk-filepage-used-people-permission"},style:{cursor:"pointer"},text:c,events:{click:BX.delegate(function(e){BX.PreventDefault(e);if(a){return}this.openPopupMenuWithRights(e,n)},this)}})]}),BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col3 tar"},children:[!t||a?BX.create("span",{props:{className:"bx-disk-filepage-used-people-del"},events:{click:BX.delegate(function(e){BX.onCustomEvent("onDetachRight",[n]);if(!a){BX.SocNetLogDestination.deleteItem(n,p,i)}var t=e.target||e.srcElement;BX.remove(t.parentNode.parentNode)},this)}}):null]})]}))},appendSystemRight:function(e){var t=e.destFormName;var a=e.isBitrix24||false;var i=e.item.id;var n=e.item.name;var o=e.item.avatar;var r=e.type;var p=e.right||{};var d=e.readOnly;if(a&&i&&i!="G2"&&i.search("G")==0){return}if(!p.title&&p.id){p.title=s[p.id].TITLE}else if(!p.title){var l=this.getFirstModuleTask();p={id:l.ID,title:l.TITLE};BX.onCustomEvent("onChangeSystemRight",[i,l])}var c=p.title;BX("bx-disk-popup-shared-people-list").appendChild(BX.create("tr",{attrs:{"data-dest-id":i},children:[BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col1"},children:[BX.create("a",{props:{className:"bx-disk-filepage-used-people-link"},children:[BX.create("span",{props:{className:"bx-disk-filepage-used-people-avatar "+(r!="users"?" group":"")},style:{backgroundImage:o?"url("+o+")":null}}),BX.util.htmlspecialchars(n)]})]}),BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col2"},children:[d?BX.create("span",{props:{className:"bx-disk-filepage-used-people-permission-read-only"},text:c}):BX.create("a",{props:{className:"bx-disk-filepage-used-people-permission"},text:c,events:{click:BX.delegate(function(e){BX.PreventDefault(e);this.openPopupMenuWithRights(e,i)},this)}})]}),BX.create("td",{props:{className:"bx-disk-popup-shared-people-list-col3 tar"},children:[!d?BX.create("span",{props:{className:"bx-disk-filepage-used-people-del"},events:{click:BX.delegate(function(e){BX.onCustomEvent("onDetachSystemRight",[i]);var t=e.target||e.srcElement;BX.remove(t.parentNode.parentNode)},this)}}):null]})]}))},showSharingDetailWithoutEdit:function(e){e=e||{};var t=e.object.id;var s=e.ajaxUrl;BX.Disk.modalWindowLoader(BX.Disk.addToLinkParam(s,"action","showSharingDetail"),{id:"folder_list_sharing_detail_object_"+t,responseType:"json",postData:{objectId:t},afterSuccessLoad:BX.delegate(function(e){if(e.status!="success"){e.errors=e.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:e.errors.pop().message})}var t={name:e.owner.name,avatar:e.owner.avatar,link:e.owner.link};BX.Disk.modalWindow({modalId:"bx-disk-detail-sharing-folder",title:BX.message("DISK_JS_SHARING_LABEL_TITLE_MODAL_2"),contentClassName:"",contentStyle:{},events:{onAfterPopupShow:BX.delegate(function(){for(var t in e.members){if(!e.members.hasOwnProperty(t)){continue}BX.Disk.appendNewShared({destFormName:this.destFormName,readOnly:true,item:{id:e.members[t].entityId,name:e.members[t].name,avatar:e.members[t].avatar},type:e.members[t].type,right:e.members[t].right})}},this),onPopupClose:function(){this.destroy()}},content:[BX.create("div",{props:{className:"bx-disk-popup-content"},children:[BX.create("table",{props:{className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_JS_SHARING_LABEL_OWNER")+"</td>"+"</tr>"}),BX.create("tr",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-col1" style="border-bottom: none;"><a class="bx-disk-filepage-used-people-link" href="'+t.link+'"><span class="bx-disk-filepage-used-people-avatar" style="background-image: url('+t.avatar+');"></span>'+BX.util.htmlspecialchars(t.name)+"</a></td>"+"</tr>"})]}),BX.create("table",{props:{id:"bx-disk-popup-shared-people-list",className:"bx-disk-popup-shared-people-list"},children:[BX.create("thead",{html:"<tr>"+'<td class="bx-disk-popup-shared-people-list-head-col1">'+BX.message("DISK_JS_SHARING_LABEL_NAME_RIGHTS_USER")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col2">'+BX.message("DISK_JS_SHARING_LABEL_NAME_RIGHTS")+"</td>"+'<td class="bx-disk-popup-shared-people-list-head-col3"></td>'+"</tr>"})]}),BX.create("div",{html:'<span class="feed-add-destination-input-box" id="feed-add-post-destination-input-box">'+'<input autocomplete="off" type="text" value="" class="feed-add-destination-inp" id="feed-add-post-destination-input"/>'+"</span>"})]})],buttons:[new BX.PopupWindowButton({text:BX.message("DISK_JS_BTN_CLOSE"),events:{click:function(){BX.PopupWindowManager.getCurrentPopup().close()}}})]})},this)})},openWindowForSelectDocumentService:function(e){var t=e.viewInUf||false;var s=BX.message("disk_document_service");var a=[new BX.PopupWindowButton({text:BX.message("DISK_JS_BTN_SAVE"),className:"popup-window-button-accept",events:{click:function(t){var s=BX.hasClass(BX("bx-disk-info-popup-btn-local"),"bx-disk-info-popup-btn-active")?"l":"gdrive";if(BX.type.isFunction(e.onSave)){e.onSave(s)}BX.PreventDefault(t);return false}}}),new BX.PopupWindowButton({text:BX.message("DISK_JS_BTN_CLOSE"),events:{click:function(e){BX.PopupWindowManager.getCurrentPopup().destroy();BX.PreventDefault(e);return false}}})];var i=t?"":"2";var n=BX.message("LANGUAGE_ID");var o="/bitrix/images/disk/disk_description"+i+"_en.png";if(n=="kz")n="ru";switch(n){case"ru":case"en":case"de":case"ua":case"br":case"la":case"sc":case"tc":o="/bitrix/images/disk/disk_description"+i+"_"+n+".png";break}var r='<div class="bx-disk-info-popup-cont-title">'+BX.message("DISK_JS_SERVICE_CHOICE_TITLE")+"</div>"+'<div class="bx-disk-info-popup-btn-wrap">'+'<span id="bx-disk-info-popup-btn-local" class="bx-disk-info-popup-btn bx-disk-info-popup-btn-local '+(!s||s=="l"?"bx-disk-info-popup-btn-active":"")+' ">'+'<span class="bx-disk-info-popup-btn-text">'+BX.message("DISK_JS_SERVICE_LOCAL_TITLE")+"</span>"+'<span class="bx-disk-info-popup-btn-descript">'+BX.message("DISK_JS_SERVICE_LOCAL_TEXT")+"</span>"+'<span class="bx-disk-info-popup-btn-check"></span>'+"</span>"+'<span id="bx-disk-info-popup-btn-cloud" class="bx-disk-info-popup-btn bx-disk-info-popup-btn-cloud '+(!!s&&s!="l"?"bx-disk-info-popup-btn-active":"")+' ">'+'<span class="bx-disk-info-popup-btn-text">'+BX.message("DISK_JS_SERVICE_CLOUD_TITLE")+"</span>"+'<span class="bx-disk-info-popup-btn-descript">'+BX.message("DISK_JS_SERVICE_CLOUD_TEXT")+"</span>"+'<span class="bx-disk-info-popup-btn-check"></span>'+"</span>"+"</div>"+'<div class="bx-disk-info-descript">'+(t?BX.message("DISK_JS_SERVICE_HELP_TEXT"):BX.message("DISK_JS_SERVICE_HELP_TEXT_2"))+'<img style="height: 182px;" class="bx-disk-info-descript-img" src="'+o+'" alt=""/>'+"</div>";BX.Disk.modalWindow({modalId:"bx-disk-select-doc-service",events:{onAfterPopupShow:function(){BX.bind(BX("bx-disk-info-popup-btn-cloud"),"click",function(){if(BX.hasClass(this,"bx-disk-info-popup-btn-active"))return;BX.toggleClass(this,"bx-disk-info-popup-btn-active");BX.toggleClass(BX("bx-disk-info-popup-btn-local"),"bx-disk-info-popup-btn-active")});BX.bind(BX("bx-disk-info-popup-btn-local"),"click",function(){if(BX.hasClass(this,"bx-disk-info-popup-btn-active"))return;BX.toggleClass(this,"bx-disk-info-popup-btn-active");BX.toggleClass(BX("bx-disk-info-popup-btn-cloud"),"bx-disk-info-popup-btn-active")})},onPopupClose:function(){this.destroy()}},zIndex:3e3,title:BX.message("DISK_JS_SERVICE_CHOICE_TITLE_SMALL"),content:[BX.create("div",{html:r})],buttons:a})}}}()}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:50:"/bitrix/js/disk/file_dialog.min.js?152698248525023";s:6:"source";s:30:"/bitrix/js/disk/file_dialog.js";s:3:"min";s:34:"/bitrix/js/disk/file_dialog.min.js";s:3:"map";s:34:"/bitrix/js/disk/file_dialog.map.js";}"*/
(function(){var i=window.BX;if(i.DiskFileDialog)return;i.DiskFileDialog={popupWindow:null,popupWaitWindow:null,timeout:null,sendRequest:false,obCallback:{},obLocalize:{},obType:{},obTypeItems:{},sortMode:"ord",searchContext:{},obItems:{},obItemsDisabled:{},obItemsSelected:{},obItemsSelectEnabled:{},obItemsSelectMulti:{},obFolderByPath:{},obCurrentPath:{},obCurrentTab:{},obGridColumn:{},obGridOrder:{},obElementBindPopup:{},obButtonSaveDisabled:{},obInitItems:{},obInitItemsDisabled:{},obInitItemsSelected:{}};i.DiskFileDialog.init=function(e){if(!e.name)e.name="fd";i.DiskFileDialog.searchContext={};i.DiskFileDialog.obCallback[e.name]=e.callback;i.DiskFileDialog.obType[e.name]=e.type;i.DiskFileDialog.obTypeItems[e.name]=e.typeItems;i.DiskFileDialog.obLocalize[e.name]=e.localize;i.DiskFileDialog.obCurrentPath[e.name]=e.currentPath?e.currentPath:"/";i.DiskFileDialog.obCurrentTab[e.name]=e.currentTabId?i.DiskFileDialog.obTypeItems[e.name][e.currentTabId]:null;i.DiskFileDialog.obFolderByPath[e.name]=e.folderByPath?e.folderByPath:{};if(i.DiskFileDialog.obCurrentTab[e.name]!==null)i.DiskFileDialog.obFolderByPath[e.name]["/"]={id:"root",type:"folder",extra:"",name:i.DiskFileDialog.obTypeItems[e.name][e.currentTabId].name,path:"/",size:"",sizeInt:"0",modifyBy:"",modifyDate:"",modifyDateInt:"0"};i.DiskFileDialog.obItems[e.name]=e.items;i.DiskFileDialog.obItemsDisabled[e.name]=e.itemsDisabled;i.DiskFileDialog.obItemsSelected[e.name]=e.itemsSelected;i.DiskFileDialog.obItemsSelectEnabled[e.name]=e.itemsSelectEnabled;i.DiskFileDialog.obItemsSelectMulti[e.name]=e.itemsSelectMulti;i.DiskFileDialog.obElementBindPopup[e.name]=e.bindPopup;i.DiskFileDialog.obGridColumn[e.name]=e.gridColumn;i.DiskFileDialog.obGridOrder[e.name]=e.gridOrder;var l=i.util.objectSort(i.DiskFileDialog.obTypeItems[e.name],"name","asc");for(var a=0,o=l.length;a<o;a++){var t=l[a];if(i.DiskFileDialog.obType[e.name][t.type]){if(i.DiskFileDialog.obType[e.name][t.type].items)i.DiskFileDialog.obType[e.name][t.type].items.push(t.id);else i.DiskFileDialog.obType[e.name][t.type].items=[t.id]}}if(i.DiskFileDialog.obCurrentTab[e.name]==null){var s=i.util.objectSort(i.DiskFileDialog.obType[e.name],"order","asc");for(var a=0,o=l.length;a<o;a++){var t=l[a];if(t.type==s[0].id){i.DiskFileDialog.obCurrentPath[e.name]="/";i.DiskFileDialog.obCurrentTab[e.name]=i.DiskFileDialog.obTypeItems[e.name][t.id];i.DiskFileDialog.obFolderByPath[e.name]["/"]={id:"root",type:"folder",extra:"",name:i.DiskFileDialog.obTypeItems[e.name][t.id].name,path:"/",size:"",sizeInt:"0",modifyBy:"",modifyDate:"",modifyDateInt:"0"};break}}}for(var a in i.DiskFileDialog.obItemsSelected[e.name]){if(i.DiskFileDialog.obItems[e.name][a])i.DiskFileDialog.obItemsSelected[e.name][a]=i.DiskFileDialog.obItems[e.name][a].type;else delete i.DiskFileDialog.obItemsSelected[e.name][a]}i.DiskFileDialog.obInitItems[e.name]=i.clone(i.DiskFileDialog.obItems[e.name]);i.DiskFileDialog.obInitItemsSelected[e.name]=i.clone(i.DiskFileDialog.obItemsSelected[e.name]);i.DiskFileDialog.obInitItemsDisabled[e.name]=i.clone(i.DiskFileDialog.obItemsDisabled[e.name]);i.DiskFileDialog.obButtonSaveDisabled[e.name]=false;i.onCustomEvent(i.DiskFileDialog,"inited",[e.name]);var n=true;for(var a in e.items){n=false;break}if(n)i.DiskFileDialog.loadItems(i.DiskFileDialog.obCurrentTab[e.name],e.name)};i.DiskFileDialog.openDialog=function(e){if(!e)e="fd";if(i.DiskFileDialog.popupWindow!=null){i.DiskFileDialog.popupWindow.close();return false}i.DiskFileDialog.popupWindow=new i.PopupWindow("DiskFileDialog",i.DiskFileDialog.obElementBindPopup[e].node,{offsetLeft:parseInt(i.DiskFileDialog.obElementBindPopup[e].offsetLeft),offsetTop:parseInt(i.DiskFileDialog.obElementBindPopup[e].offsetTop),bindOptions:{forceBindPosition:true},zIndex:100,closeByEsc:true,closeIcon:true,draggable:i.DiskFileDialog.obElementBindPopup[e].node==null?{restrict:true}:false,titleBar:i.DiskFileDialog.obLocalize[e].title,contentColor:"white",contentNoPaddings:true,events:{onPopupClose:function(){if(i.DiskFileDialog.popupWaitWindow!==null)i.DiskFileDialog.popupWaitWindow.close();var e=i("bx-file-list-dialog-search-form");if(e){i.unbind(e,"submit",i.proxy(i.DiskFileDialog.onSubmitSearchForm,true));i.unbind(i("bx-file-title-button-search-input"),"keyup",i.proxy(i.DiskFileDialog.onFileSearch,this));i("bx-file-title-button-search-input").setAttribute("data-prev-search","")}this.destroy()},onPopupDestroy:function(){i.DiskFileDialog.popupWindow=null;if(i.DiskFileDialog.obCallback[e]&&i.DiskFileDialog.obCallback[e].popupDestroy){i.DiskFileDialog.obCallback[e].popupDestroy()}},onPopupShow:i.delegate(function(){if(i.DiskFileDialog.obCallback[e]&&i.DiskFileDialog.obCallback[e].popupShow){i.DiskFileDialog.obCallback[e].popupShow()}var l=i("bx-file-list-dialog-search-form");if(l){i.bind(l,"submit",i.proxy(i.DiskFileDialog.onSubmitSearchForm,this));i.bind(i("bx-file-title-button-search-input"),"keyup",i.proxy(i.DiskFileDialog.onFileSearch,this))}},this)},content:'<div class="bx-file-dialog-container">'+'<div class="bx-file-dialog-tab">'+'<div class="bx-file-dialog-tab-wrap" id="bx-file-dialog-tab-'+e+'">'+i.DiskFileDialog.getTabsHtml(e)+"</div>"+"</div>"+'<div id="bx-file-list-dialog-search-cont" class="bx-file-list-dialog-search" style="">'+'<form data-name="'+e+'" id="bx-file-list-dialog-search-form" onsubmit="" action="" method="GET" name="bx-file-filter-title-form" style="display: block;">'+'<input data-name="'+e+'" class="bx-file-list-dialog-search-input" id="bx-file-title-button-search-input" name="title_value" autocomplete="off" type="text" style="width: 610px;margin-bottom: 6px;margin-right: 8px;">'+'<span onclick="BX.fireEvent(BX(\'bx-file-list-dialog-search-form\'), \'submit\')" class="bx-file-list-dialog-search-icon" id="bx-file-title-button-search-icon"></span>'+"</form>"+"</div>"+'<div class="bx-file-dialog-content" style="margin-left: 199px;height: 254px;" id="bx-file-dialog-content-'+e+'">'+i.DiskFileDialog.getItemsHtml(e)+"</div>"+"</div>"+'<div class="bx-file-dialog-notice" id="bx-file-dialog-notice-'+e+'">'+'<div class="popup-window-hr popup-window-buttons-hr"><i></i></div>'+'<div class="bx-file-dialog-notice-wrap"></div>'+"</div>",buttons:[new i.PopupWindowButton({text:i.DiskFileDialog.obLocalize[e].saveButton,className:"popup-window-button-disabled",events:{click:function(){if(i.DiskFileDialog.obButtonSaveDisabled[e])return false;i.DiskFileDialog.obInitItems[e]=i.clone(i.DiskFileDialog.obItems[e]);i.DiskFileDialog.obInitItemsSelected[e]=i.clone(i.DiskFileDialog.obItemsSelected[e]);i.DiskFileDialog.obInitItemsDisabled[e]=i.clone(i.DiskFileDialog.obItemsDisabled[e]);if(i.DiskFileDialog.obCallback[e]&&i.DiskFileDialog.obCallback[e].saveButton){var l={};for(var a in i.DiskFileDialog.obItemsSelected[e])l[a]=i.DiskFileDialog.obItems[e][a];i.DiskFileDialog.obCallback[e].saveButton(i.DiskFileDialog.obCurrentTab[e],i.DiskFileDialog.obCurrentPath[e],l,i.DiskFileDialog.obFolderByPath[e][i.DiskFileDialog.obCurrentPath[e]])}this.popupWindow.close()}}}),new i.PopupWindowButtonLink({text:i.DiskFileDialog.obLocalize[e].cancelButton,className:"popup-window-button-link-cancel",events:{click:function(){i.DiskFileDialog.obItems[e]=i.clone(i.DiskFileDialog.obInitItems[e]);i.DiskFileDialog.obItemsSelected[e]=i.clone(i.DiskFileDialog.obInitItemsSelected[e]);i.DiskFileDialog.obItemsDisabled[e]=i.clone(i.DiskFileDialog.obInitItemsDisabled[e]);if(i.DiskFileDialog.obCallback[e]&&i.DiskFileDialog.obCallback[e].cancelButton){var l={};for(var a in i.DiskFileDialog.obItemsSelected[e])l[a]=i.DiskFileDialog.obItems[e][a];i.DiskFileDialog.obCallback[e].cancelButton(i.DiskFileDialog.obCurrentTab[e],i.DiskFileDialog.obCurrentPath[e],l,i.DiskFileDialog.obFolderByPath[e][i.DiskFileDialog.obCurrentPath[e]])}this.popupWindow.close()}}})]});i.DiskFileDialog.popupWindow.show();i.DiskFileDialog.slidePath(e)};var e;i.DiskFileDialog.onFileSearch=function(l){if(l.keyCode==16||l.keyCode==18||l.keyCode==20||l.keyCode==244||l.keyCode==91)return false;var a=l.target;var o=l.target.getAttribute("data-name");if(l.keyCode==27&&a.getAttribute("data-prev-search")!=""){a.value="";a.setAttribute("data-prev-search","");i.DiskFileDialog.loadItems(i.DiskFileDialog.obCurrentTab[o],o);return i.PreventDefault(l)}if(a.value==""&&a.getAttribute("data-prev-search")!=""){a.setAttribute("data-prev-search","");i.DiskFileDialog.loadItems(i.DiskFileDialog.obCurrentTab[o],o);return i.PreventDefault(l)}if(!i.type.isFunction(e)){e=i.debounce(function(e){if(e.getAttribute("data-prev-search")===e.value)return i.PreventDefault(l);if(i.DiskFileDialog.searchFileByName(e.value,o)){e.setAttribute("data-prev-search",e.value)}return i.PreventDefault(l)},500,this)}e(a)};i.DiskFileDialog.onSubmitSearchForm=function(e){return i.PreventDefault(e)};i.DiskFileDialog.searchFileByName=function(e,l){var a=null;var o=null;if(e.length<3)return false;if(i.DiskFileDialog.obCurrentTab[l].type==="recently_used")a=i.DiskFileDialog.obCurrentTab[l].type;else if(!i.DiskFileDialog.obCurrentPath[l]||i.DiskFileDialog.obCurrentPath[l]==="/"){a="storage";o=i.DiskFileDialog.obCurrentPath[l]}i.Disk.ajax({url:i.Disk.addToLinkParam(i.DiskFileDialog.target[l],"action","searchFile"),method:"POST",dataType:"json",data:{FORM_NAME:l,storageId:i.DiskFileDialog.obCurrentTab[l].id,storageType:i.DiskFileDialog.obCurrentTab[l].type,entityType:a,entityId:o||0,searchQuery:e,searchContext:i.DiskFileDialog.searchContext},onsuccess:i.delegate(function(e){i.DiskFileDialog.obItems[l]={};i.DiskFileDialog.obItemsSelected[l]={};i.DiskFileDialog.obItemsDisabled[l]={};for(var a in e.items){if(!e.items.hasOwnProperty(a))continue;i.DiskFileDialog.obItems[l][a]=e.items[a]}var o=i("bx-file-dialog-content-"+l);if(o)o.innerHTML=i.DiskFileDialog.getItemsHtml(l,e.sortMode)},this)});return true};i.DiskFileDialog.selectTab=function(e,l,a){if(!a)a="fd";if(i.DiskFileDialog.obCurrentTab[a]&&i.DiskFileDialog.obCurrentTab[a].id==l&&i.DiskFileDialog.obCurrentPath[a]=="/"){return false}i.DiskFileDialog.obCurrentPath[a]="/";i.DiskFileDialog.obCurrentTab[a]=i.DiskFileDialog.obTypeItems[a][l];i.DiskFileDialog.obFolderByPath[a]={};i.DiskFileDialog.obFolderByPath[a][i.DiskFileDialog.obCurrentPath[a]]={id:"root",type:"folder",extra:"",name:i.DiskFileDialog.obTypeItems[a][l].name,path:"/",size:"",sizeInt:"0",modifyBy:"",modifyDate:"",modifyDateInt:"0"};if(e!==null){var o=i.findChildren(i("bx-file-dialog-tab-"+a),{className:"bx-file-dialog-tab-item-active"},true);if(o!=null){for(var t=0;t<o.length;t++)o[t].className="bx-file-dialog-tab-item-link"}e.className="bx-file-dialog-tab-item-link bx-file-dialog-tab-item-active"}var s=i("bx-file-title-button-search-input");if(s.value!=""){i.DiskFileDialog.searchFileByName(s.value,a)}else{i.DiskFileDialog.loadItems(i.DiskFileDialog.obCurrentTab[a],a)}return false};i.DiskFileDialog.loadItems=function(e,l){if(i.DiskFileDialog.sendRequest)return false;if(!l)l="fd";if(!i.DiskFileDialog.target)i.DiskFileDialog.target={};if(!!e.link)i.DiskFileDialog.target[l]=e.link;i.onCustomEvent(i.DiskFileDialog,"loadItems",[e.link,l]);i.Disk.ajax({url:i.DiskFileDialog.target[l],method:"POST",dataType:"json",data:{WD_LOAD_ITEMS:"Y",FORM_NAME:l,FORM_TAB_ID:i.DiskFileDialog.obCurrentTab[l].id,FORM_TAB_TYPE:i.DiskFileDialog.obCurrentTab[l].type,FORM_PATH:i.DiskFileDialog.obCurrentPath[l].split("//").join("/"),searchContext:i.DiskFileDialog.searchContext},onsuccess:i.delegate(function(a){var o=i("bx-file-list-dialog-search-cont");if(a.authUrl){i.DiskFileDialog.closeWait(l);i.DiskFileDialog.sendRequest=false;var t=i("bx-file-dialog-content-"+l);if(!t)return;if(o)i.hide(o);t.innerHTML='<div class="bx-file-dialog-content" style="margin-left: 0;">'+'<div class="bx-file-dialog-content-wrap-inner">'+'<div class="bx-file-dialog-content-wrap-title">'+i.message("DISK_JS_FILE_DIALOG_OAUTH_NOTICE").replace("#SERVICE#",e.name)+"</div>"+'<div class="bx-file-dialog-content-wrap-text">'+i.message("DISK_JS_FILE_DIALOG_OAUTH_NOTICE_DETAIL").replace("#HELP_URL#",i.message("DISK_JS_FILE_DIALOG_OAUTH_NOTICE_DETAIL_HELP_URL"))+"</div>"+"</div>"+"</div>";i.bind(i("bx-js-disk-run-oauth-modal"),"click",function(e){i.util.popup(a.authUrl,1030,700);i.PreventDefault(e);return false});i.bind(window,"hashchange",i.proxy(function(){var a=document.location.hash.match(/external-auth-(\w+)/);if(!a)return;i.DiskFileDialog.sendRequest=false;this.loadItems(e,l)},this));return}if(a.status&&a.status==="error"){a.errors=a.errors||[{}];i.Disk.showModalWithStatusAction({status:"error",message:a.errors.pop().message});i.DiskFileDialog.closeWait(l);i.DiskFileDialog.sendRequest=false;i.cleanNode(i("bx-file-dialog-content-"+l));return}if(i.DiskFileDialog.obType[l][i.DiskFileDialog.obCurrentTab[l].type].searchable){if(o){i.show(o,"block")}var s=i("bx-file-dialog-content-"+l);if(s){s.style.height="254px";var n=i.findChild(s,{tagName:"div",className:"bx-file-dialog-content-wrap"},true);if(n){n.style.cssText=""}}}else{if(o){i.hide(o)}var s=i("bx-file-dialog-content-"+l);if(s){s.style.height="288px";var n=i.findChild(s,{tagName:"div",className:"bx-file-dialog-content-wrap"},true);if(n){n.style.height="257px"}}}i.DiskFileDialog.obItems[a.FORM_NAME]={};i.DiskFileDialog.obItemsSelected[a.FORM_NAME]={};i.DiskFileDialog.obItemsDisabled[a.FORM_NAME]={};for(var r in a.FORM_ITEMS)i.DiskFileDialog.obItems[a.FORM_NAME][r]=a.FORM_ITEMS[r];for(var r in a.FORM_ITEMS_DISABLED)i.DiskFileDialog.obItemsDisabled[a.FORM_NAME][r]=a.FORM_ITEMS_DISABLED[r];var D=i("bx-file-dialog-content-"+l);if(D)D.innerHTML=i.DiskFileDialog.getItemsHtml(l,a.sortMode);i.DiskFileDialog.slidePath(l);i.DiskFileDialog.closeWait(l);i.DiskFileDialog.sendRequest=false;i.onCustomEvent(i.DiskFileDialog,"loadItemsDone",[l])},this),onfailure:function(e){i.DiskFileDialog.sendRequest=false}});i.DiskFileDialog.showWait(500,l);i.DiskFileDialog.sendRequest=true;return false};i.DiskFileDialog.selectColumn=function(e,l,a){if(!e)e="name";i.DiskFileDialog.obGridOrder[a].column=!e?"name":e;i.DiskFileDialog.obGridOrder[a].order=!l?"desc":l;var o=i("bx-file-dialog-content-"+a);if(o)o.innerHTML=i.DiskFileDialog.getItemsHtml(a);i.DiskFileDialog.slidePath(a);return false};i.DiskFileDialog.selectItem=function(e,l,a){if(!a)a="fd";if(i.DiskFileDialog.obItemsSelected[a][l]){i.DiskFileDialog.unSelectItem(e,l,a)}else{if(!i.DiskFileDialog.obItemsSelectMulti[a]){var o=i.findChildren(i("bx-file-dialog-content-"+a),{className:"bx-file-dialog-row-selected"},true);if(o!=null){for(var t=0,s=o.length;t<s;t++)i.DiskFileDialog.unSelectItem(o[t],o[t].getAttribute("data-id"),a)}else{for(var t in i.DiskFileDialog.obItemsSelected[a])delete i.DiskFileDialog.obItemsSelected[a][t]}}if(e!==null){i.removeClass(e,"bx-file-dialog-row-normal");i.addClass(e,"bx-file-dialog-row-selected");i.onCustomEvent(i.DiskFileDialog,"selectItem",[e,l,a])}i.DiskFileDialog.obItemsSelected[a][l]=i.DiskFileDialog.obItems[a][l].type}if(i.Disk.isEmptyObject(i.DiskFileDialog.obItemsSelected[a])){i.DiskFileDialog.disableSave(a)}else{i.DiskFileDialog.enableSave(a)}return false};i.DiskFileDialog.unSelectItem=function(e,l,a){if(!a)a="fd";i.removeClass(e,"bx-file-dialog-row-selected");i.addClass(e,"bx-file-dialog-row-normal");delete i.DiskFileDialog.obItemsSelected[a][l];if(i.Disk.isEmptyObject(i.DiskFileDialog.obItemsSelected[a])){i.DiskFileDialog.disableSave(a)}i.onCustomEvent(i.DiskFileDialog,"unSelectItem",[e,l,a]);return false};i.DiskFileDialog._rtrimFolder=function(i){if(i.length>1){var e=i.split("/");if(e[e.length-1]=="")e.pop();e.pop();i=e.join("/");if(i.length<1)i="/"}else{i=false}return i};i.DiskFileDialog.openSpecifiedFolder=function(e,l){if(!l)l="fd";i.DiskFileDialog.obCurrentPath[l]=e;if(e!=="/"){var a=e;if(a.slice(-1)==="/"){a=a.substring(0,a.length-1)}if(i.DiskFileDialog.obFolderByPath[l][a]&&i.DiskFileDialog.obFolderByPath[l][a].provider){i.DiskFileDialog.loadItems({link:i.DiskFileDialog.obFolderByPath[l][a].link},l);return false}}var o=i.DiskFileDialog.obCurrentTab[l].link;var t=o.indexOf("index.php");if(t>=0){if(e=="/"){e=""}else{o=o.substring(0,t)}}e=o+e;e=e.split("//").join("/");i.DiskFileDialog.loadItems({link:o},l);return false};i.DiskFileDialog.openParentFolder=function(e){if(!e)e="fd";if(!!i.DiskFileDialog.obCurrentTab[e]){var l=i.DiskFileDialog._rtrimFolder(i.DiskFileDialog.obCurrentPath[e]);i.DiskFileDialog.openSpecifiedFolder(l,e);return false}return false};i.DiskFileDialog.openFolder=function(e,l,a){if(!a)a="fd";if(!i.DiskFileDialog.obItems[a][l].path){i.DiskFileDialog.obCurrentPath[a]=(i.DiskFileDialog.obCurrentPath[a]==="/"?"/":i.DiskFileDialog.obCurrentPath[a]+"/")+i.DiskFileDialog.obItems[a][l].name}else{i.DiskFileDialog.obCurrentPath[a]=i.DiskFileDialog.obItems[a][l].path}i.DiskFileDialog.obFolderByPath[a][i.DiskFileDialog.obCurrentPath[a]]=i.DiskFileDialog.obItems[a][l];i.removeClass(e,"bx-file-dialog-row-selected");i.addClass(e,"bx-file-dialog-row-normal");i.DiskFileDialog.loadItems(i.DiskFileDialog.obItems[a][l],a);return false};i.DiskFileDialog.getTabsHtml=function(e){if(!e)e="fd";var l="";var a=i.util.objectSort(i.DiskFileDialog.obType[e],"order","asc");for(var o=0,t=a.length;o<t;o++){var s="";var n=a[o];s='<div class="bx-file-dialog-tab-group">';if(n.name)s+='<div class="bx-file-dialog-tab-group-title">'+n.name+"</div>";if(n.items){for(var r=0;r<n.items.length;r++){var D=i.DiskFileDialog.obTypeItems[e][n.items[r]];var d=i.DiskFileDialog.obCurrentTab[e].id==D.id?" bx-file-dialog-tab-item-active":"";s+='<div class="bx-file-dialog-tab-item">'+'<a href="#" class="bx-file-dialog-tab-item-link'+d+'" data-id="'+D.id+'" data-type="'+D.type+'" onclick="return BX.DiskFileDialog.selectTab(this, \''+D.id+"', '"+e+"')\">"+'<span class="bx-file-dialog-tab-item-link-text" title="'+i.util.htmlspecialchars(D.name)+'">'+i.util.htmlspecialchars(D.name)+"</span>"+'<span class="bx-file-dialog-tab-item-link-arrow"></span>'+"</a>"+"</div>"}}s+="</div>";if(n.items){l+=s}}return l};i.DiskFileDialog.getItemsHtml=function(e,l){if(!e)e="fd";if(!l)l=i.DiskFileDialog.sortMode;var a="";if(i.DiskFileDialog.obCurrentPath[e]=="/")a='<div class="bx-file-dialog-content-root">';a+='<div class="bx-file-dialog-header">';for(var o in i.DiskFileDialog.obGridColumn[e]){var t=i.DiskFileDialog.obGridColumn[e][o];var s=i.DiskFileDialog.obGridOrder[e].column==t.sort?true:false;a+='<span class="bx-file-dialog-column-header bx-file-dialog-column-'+t.id+'" style="'+t.style+'">'+'<a href="#sort" class="bx-file-dialog-sort-link'+(s?" bx-file-dialog-sort-active":"")+'"  onclick="return BX.DiskFileDialog.selectColumn(\''+t.sort+"', '"+(s?i.DiskFileDialog.obGridOrder[e].order=="desc"?"asc":"desc":"desc")+"', '"+e+"')\">"+i.util.htmlspecialchars(t.name)+'<span class="bx-file-dialog-sort-icon bx-file-dialog-sort-'+(s?i.DiskFileDialog.obGridOrder[e].order:"desc")+'"></span>'+"</a>"+"</span>"}a+="</div>";var n=i.DiskFileDialog.obCurrentPath[e].split("/");a+='<div class="bx-file-dialog-content-path">'+'<a href="#up" class="bx-file-dialog-content-path-up bx-file-dialog-icon bx-file-dialog-icon-up" onclick="return BX.DiskFileDialog.openParentFolder(\''+e+"');\"></a>"+'<span class="bx-file-dialog-content-path-items"><span class="bx-file-dialog-content-path-items-wrap" id="bx-file-dialog-content-path-items-wrap-'+e+'"> '+"<a href=\"#library\" onclick=\"return BX.DiskFileDialog.openSpecifiedFolder('/', '"+e+'\')" class="bx-file-dialog-content-path-link">'+i.util.htmlspecialchars(i.DiskFileDialog.obCurrentTab[e].name)+"</a>";var r="/";if(n[n.length-1]=="")n.pop();for(var o=0,D=n.length;o<D;o++){if(o==0||o==D)continue;r+=n[o]+"/";a+='<span class="bx-file-dialog-content-path-seporator bx-file-dialog-icon bx-file-dialog-icon-seporator"></span>';a+='<a href="#'+n[o]+'" onclick="return BX.DiskFileDialog.openSpecifiedFolder(\''+r+"', '"+e+'\')" class="bx-file-dialog-content-path-link '+(o==D-1?"bx-file-dialog-content-path-link-active":"")+'">'+n[o]+"</a>"}a+="</span></span>";a+="</div>";a+='<div class="bx-file-dialog-content-wrap">';var d="";var g="";var b="";var f=i.util.objectSort(i.DiskFileDialog.obItems[e],i.DiskFileDialog.obGridOrder[e].column,i.DiskFileDialog.obGridOrder[e].order);for(var o=0,D=f.length;o<D;o++){var c=f[o];var u=i.DiskFileDialog.obItemsSelected[e][c.id]?" bx-file-dialog-row-selected":" bx-file-dialog-row-normal";var k=false;var p=false;if(i.DiskFileDialog.obItemsDisabled[e][c.id])p=true;if(p&&c.type=="folder")k=true;if(!p){p=true;var F=0;for(var m in i.DiskFileDialog.obItemsSelectEnabled[e]){F++;if(m=="all"){p=false;break}else if(m=="onlyFiles"){p=false;if(c.type=="folder")k=true;break}else if(m==c.type){p=false}}if(F<=0)p=false}var h="";if(p){u=" bx-file-dialog-row-disabled";if(i.DiskFileDialog.obItemsDisabled[e]&&i.DiskFileDialog.obItemsDisabled[e][c.id]&&i.DiskFileDialog.obItemsDisabled[e][c.id]["hint"]){h=". "+i.DiskFileDialog.obItemsDisabled[e][c.id]["hint"]}}var v="";var I="";if(!p){var v="onclick=\"return BX.DiskFileDialog.selectItem(this, '"+c.id+"', '"+e+"')\"";var I="";if(c.type=="folder"){v=k?"onclick=\"return BX.DiskFileDialog.openFolder(this, '"+c.id+"', '"+e+"')\"":v;I=k?"":"ondblclick=\"return BX.DiskFileDialog.openFolder(this, '"+c.id+"', '"+e+"')\""}}b="<div "+v+" "+I+' class="bx-file-dialog-row '+u+'" data-id="'+c.id+'">';var x=true;for(var y in i.DiskFileDialog.obGridColumn[e]){var t=i.DiskFileDialog.obGridColumn[e][y];var C=c.extra&&c.extra!=""?" bx-file-dialog-extra-"+c.extra:"";if(x){b+='<span class="bx-file-dialog-column-row bx-file-dialog-column-'+t.id+""+C+'" style="'+t.style+'"  title="'+t.name+": "+i.util.htmlspecialchars(c[t.id])+h+'">';if(p){b+='<span class="bx-file-dialog-content-link bx-file-dialog-icon bx-file-dialog-icon-'+c.type+'">'+i.util.htmlspecialchars(c[t.id])+"</span>"}else{b+='<a href="#" class="bx-file-dialog-content-link bx-file-dialog-icon bx-file-dialog-icon-'+c.type+'" onclick="javascript:void(0);">'+i.util.htmlspecialchars(c[t.id])+"</a>"}b+="</span>";x=false}else{b+='<span class="bx-file-dialog-column-row bx-file-dialog-column-'+t.id+'" style="'+t.style+'" title="'+t.name+": "+i.util.htmlspecialchars(c[t.id])+'">'+i.util.htmlspecialchars(c[t.id])+"</span>"}}b+="</div>";if(l==="ord"){if(c.type=="folder")d+=b;else g+=b}else if(l==="mix"){g+=b}}a+=d+g;a+="</div>";if(i.DiskFileDialog.obCurrentPath[e]=="/")a+="</div>";return a};i.DiskFileDialog.showWait=function(e,l){if(!l)l="fd";if(i.DiskFileDialog.popupWaitWindow!==null)i.DiskFileDialog.closeWait(l);if(e>0){clearTimeout(i.DiskFileDialog.timeout);i.DiskFileDialog.timeout=setTimeout(function(){i.DiskFileDialog.showWait(0,l)},e);return false}var a=i("bx-file-dialog-content-"+l);i.DiskFileDialog.popupWaitWindow=new i.PopupWindow("DiskFileDialogWait",a,{autoHide:false,lightShadow:true,zIndex:100,content:i.create("DIV",{props:{className:"bx-file-dialog-wait"}}),events:{onPopupClose:function(){this.destroy()},onPopupDestroy:function(){i.DiskFileDialog.popupWaitWindow=null}}});if(a){var o=a.offsetHeight,t=a.offsetWidth;if(o>0&&t>0){i.DiskFileDialog.popupWaitWindow.setOffset({offsetTop:-parseInt(o/2-2),offsetLeft:parseInt(t/2-15)});i.DiskFileDialog.popupWaitWindow.show()}}return false};i.DiskFileDialog.closeWait=function(e){if(!e)e="fd";if(i.DiskFileDialog.popupWaitWindow!==null)i.DiskFileDialog.popupWaitWindow.close();clearTimeout(i.DiskFileDialog.timeout);return false};i.DiskFileDialog.enableSave=function(e){if(!e)e="fd";i.DiskFileDialog.obButtonSaveDisabled[e]=false;if(i.DiskFileDialog.popupWindow&&i.DiskFileDialog.popupWindow.buttons&&i.DiskFileDialog.popupWindow.buttons[0])i.DiskFileDialog.popupWindow.buttons[0].setClassName("popup-window-button-accept")};i.DiskFileDialog.disableSave=function(e){if(!e)e="fd";i.DiskFileDialog.obButtonSaveDisabled[e]=true;if(i.DiskFileDialog.popupWindow&&i.DiskFileDialog.popupWindow.buttons&&i.DiskFileDialog.popupWindow.buttons[0])i.DiskFileDialog.popupWindow.buttons[0].setClassName("popup-window-button-disabled")};i.DiskFileDialog.showNotice=function(e,l){if(!l)l="fd";var a=i("bx-file-dialog-notice-"+l);if(a==null)return false;i.show(a);var o=i.findChild(a,{className:"bx-file-dialog-notice-wrap"},true);o.innerHTML=e};i.DiskFileDialog.closeNotice=function(e){if(!e)e="fd";var l=i("bx-file-dialog-notice-"+e);if(l==null)return false;i.hide(l)};i.DiskFileDialog.slidePath=function(e){var l=i("bx-file-dialog-content-path-items-wrap-"+e);if(!l)return;var a=l.parentNode;if(l.offsetWidth>a.offsetWidth)i.style(l,"margin-left",-(l.offsetWidth-a.offsetWidth)+"px");i.unbind(l,"mousewheel",function(l){i.DiskFileDialog.slidePathScroll(l,e)});i.bind(l,"mousewheel",function(l){i.DiskFileDialog.slidePathScroll(l,e)})};i.DiskFileDialog.slidePathScroll=function(e,l){var a=i("bx-file-dialog-content-path-items-wrap-"+l);if(!a)return;if(a.offsetWidth<a.parentNode.offsetWidth)return false;var o=a.offsetWidth-a.parentNode.offsetWidth;var t=(parseInt(i.style(a,"margin-left"))-Math.ceil(30*i.getWheelData(e)/3))*-1;if(t>=0&&t<=o)i.style(a,"margin-left",-t+"px");else if(t>o)i.style(a,"margin-left",-o+"px");else if(t<0)i.style(a,"margin-left","0px");return i.PreventDefault(e)}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:43:"/bitrix/js/disk/queue.min.js?15269824851061";s:6:"source";s:24:"/bitrix/js/disk/queue.js";s:3:"min";s:28:"/bitrix/js/disk/queue.min.js";s:3:"map";s:28:"/bitrix/js/disk/queue.map.js";}"*/
BX.Disk.Queue=function(){var s=function(s){this.isProcessing=false;this.items=[];this.setEvents()};s.prototype.setEvents=function(){};s.prototype.process=function(){if(this.items.length<=0){return}if(this.isProcessing){return}this.isProcessing=true;var s=this.items.shift();s.run(BX.delegate(function(){this.isProcessing=false;this.process()},this))};s.prototype.push=function(s){if(BX.is_subclass_of(s,BX.Disk.QueueItem)){this.items.push(s)}return this};return s}();BX.Disk.QueueItem=function(){var s=function(s,t,i){this.object=s;this.runHandler=t;this.successFallback=null;this.subscribeOnFinish(i)};s.prototype.run=function(s){this.successFallback=s;return this.runHandler.call(this,this.object)};s.prototype.subscribeOnFinish=function(s){var t=s.call(this,this.object);if(BX.type.isString(t)){BX.addCustomEvent(t,BX.delegate(this.onFinishItem,this))}else if(BX.type.isArray(t)){BX.addCustomEvent(t[0],t[1],BX.delegate(this.onFinishItem,this))}};s.prototype.onFinishItem=function(){this.successFallback.call()};return s}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:53:"/bitrix/js/disk/external_loader.min.js?15269824854180";s:6:"source";s:34:"/bitrix/js/disk/external_loader.js";s:3:"min";s:38:"/bitrix/js/disk/external_loader.min.js";s:3:"map";s:38:"/bitrix/js/disk/external_loader.map.js";}"*/
BX.namespace("BX.Disk.ExternalLoader");BX.Disk.ExternalLoader=function(){var s=new BX.Disk.Queue;return{startLoad:function(t){var e=new BX.Disk.QueueItem(new BX.Disk.ExternalLoader.NewItemClass(t),function(s){s.start()},function(s){return[s,"onFinish"]});s.push(e).process()},reloadLoadAttachedObject:function(s){return new BX.Disk.ExternalLoader.AttachedItemClass(s)}}}();BX.Disk.ExternalLoader.NewItemClass=function(){var s=function(s){this.ajaxUrl="/bitrix/tools/disk/uf.php";this.file={id:s.file.id,service:s.file.service};this.cloudImport={};this.handlers={onFinish:s.onFinish,onProgress:s.onProgress};this.setEvents()};s.prototype.setEvents=function(){};s.prototype.onFinish=function(s){BX.onCustomEvent(this,"onFinish",[this]);this.handlers.onFinish(s.file)};s.prototype.onProgress=function(s){this.handlers.onProgress(s)};s.prototype.start=function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","startUpload"),data:{fileId:this.file.id,service:this.file.service},onsuccess:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message});return null}this.cloudImport={id:s.cloudImport.id};this.processChunkDownload()},this)})};s.prototype.processChunkDownload=function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","uploadChunk"),data:{cloudImportId:this.cloudImport.id},onsuccess:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message});return null}this.onProgress(parseInt(s.downloadedContentSize/s.contentSize*100,10));if(s.step=="finish"){this.saveAsNewFile()}else{this.processChunkDownload()}},this)})};s.prototype.saveAsNewFile=function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","saveAsNewFile"),data:{cloudImportId:this.cloudImport.id},onsuccess:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message});return null}this.onFinish(s)},this)})};return s}();BX.Disk.ExternalLoader.AttachedItemClass=function(){var s=function(s){this.ajaxUrl="/bitrix/tools/disk/uf.php";this.attachedObject={id:s.attachedObject.id,service:s.attachedObject.service};this.cloudImport={};this.handlers={onFinish:s.onFinish,onProgress:s.onProgress};this.setEvents()};s.prototype.setEvents=function(){};s.prototype.onFinish=function(s){this.handlers.onFinish(s)};s.prototype.onProgress=function(s){this.handlers.onProgress(s)};s.prototype.start=function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","reloadAttachedObject"),data:{attachedId:this.attachedObject.id,service:this.attachedObject.service},onsuccess:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message});return}if(!s.hasNewVersion){this.onFinish(s);return}this.cloudImport={id:s.cloudImport.id};this.processChunkDownload()},this)})};s.prototype.processChunkDownload=function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","uploadChunk"),data:{cloudImportId:this.cloudImport.id},onsuccess:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message});return null}this.onProgress(parseInt(s.downloadedContentSize/s.contentSize*100,10));if(s.step=="finish"){this.updateFile()}else{this.processChunkDownload()}},this)})};s.prototype.updateFile=function(){BX.Disk.ajax({method:"POST",dataType:"json",url:BX.Disk.addToLinkParam(this.ajaxUrl,"action","updateAttachedObject"),data:{attachedId:this.attachedObject.id,cloudImportId:this.cloudImport.id},onsuccess:BX.delegate(function(s){if(s.status!="success"){s.errors=s.errors||[{}];BX.Disk.showModalWithStatusAction({status:"error",message:s.errors.pop().message});return null}this.onFinish(s)},this)})};return s}();
/* End */
;
//# sourceMappingURL=kernel_disk.map.js